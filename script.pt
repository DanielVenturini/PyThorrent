#----------decodifica o arquivo--------------------------------------------
from BencodeDecode import (Decode, Bencode)
dec = Decode('torrentsproibidos/[limetorrents.cc]Lost.In.London..2017..[WEBRip].[720p].[YTS.AM].torrent')
#dec = Decode('example.torrent/linux-lite-3.8-32bit.iso.torrent')
dec.decodeFullFile()

dic = dec.dic
#--------calcula o sha1-----------------------------------------------------
import hashlib
def getSHA1(toSha1, hex=True):
    sha = hashlib.sha1()
    sha.update(toSha1)
    if(hex):
        return sha.hexdigest()
    else:
        return sha.digest()

#---------recupera as informacoes--------------------------------------------
from THP_PWP import CommonDef
announce = dic['announce']
torrentName = dic['info']['name']
lenTorrent = CommonDef.getFullLefFile(dic)
info_hash = getSHA1(dec.rawinfo)
peer_id = CommonDef.getPeerId()
port = CommonDef.getPort()
uploaded, downloaded, left = CommonDef.getProperties(torrentName, lenTorrent)

#---------cria mensagem------------------------------------------------------
mensagem = 'GET /announce?' +\
            'info_hash=' + str(info_hash) + '&' +\
            'peer_id=' + peer_id + '&' +\
            'port=' + str(port) + '&' +\
            'uploaded=' + str(uploaded) + '&' +\
            'downloaded=' + str(downloaded) + '&' +\
            'left=' + str(left) + '&' +\
            'event=started' +\
            ' HTTP/1.1\r\n\r\n'
#--------cria socket---------------------------------------------------------
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('torrent.ubuntu.com', 6969))
s.send(mensagem.encode())
s.recv(1024)
s.close()
#-------cria socket udp-----
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
ip, port = s.getsockname()
s.bind((ip, port))
s.sendto(mensagem.encode(), ('87.233.192.220', 6969))
s.recvfrom(1024)
s.close()
------------------------------------------------------------------------------
import socket
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
#s.bind(('192.168.0.105', 6969))
s.connect(('tracker.documentfoundation.org', 6969))
#s.sendto(mensagem.encode(), ('tracker.leechers-paradise.org', 6969))
#s.recvfrom(100)
s.send(mensagem.encode())
s.recv(100)
s.close()





binascii.unhexlify(info_hash)

from requests.utils import quote
quote(str)